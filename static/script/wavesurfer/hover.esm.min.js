class t{constructor(){this.listeners={}}on(t,e){return this.listeners[t]||(this.listeners[t]=new Set),this.listeners[t].add(e),()=>this.un(t,e)}once(t,e){const s=this.on(t,e),i=this.on(t,()=>{s(),i()});return s}un(t,e){this.listeners[t]&&(e?this.listeners[t].delete(e):delete this.listeners[t])}unAll(){this.listeners={}}emit(t,...e){this.listeners[t]&&this.listeners[t].forEach(t=>t(...e))}}class e extends t{constructor(t){super(),this.subscriptions=[],this.options=t}onInit(){}init(t){this.wavesurfer=t,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(t=>t())}}const s={lineWidth:1,labelSize:11};class i extends e{constructor(t){super(t||{}),this.unsubscribe=()=>{},this.onPointerMove=t=>{var e,s,i;this.wavesurfer&&(e=this.wavesurfer.getWrapper().clientWidth,t=t["offsetX"],s=Math.min(1,Math.max(0,t/e)),t=Math.min(e-this.options.lineWidth-1,t),this.wrapper.style.transform=`translateX(${t}px)`,this.wrapper.style.opacity="1",i=this.wavesurfer.getDuration()||0,this.label.textContent=this.formatTime(i*s),i=this.label.offsetWidth,this.label.style.transform=e<t+i?`translateX(-${i+this.options.lineWidth}px)`:"",this.emit("hover",s))},this.onPointerLeave=()=>{this.wrapper.style.opacity="0"},this.options=Object.assign({},s,t),this.wrapper=document.createElement("div"),this.label=document.createElement("span"),this.wrapper.appendChild(this.label)}static create(t){return new i(t)}addUnits(t){return t+("number"==typeof t?"px":"")}onInit(){if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");var t=this.wavesurfer.options,t=this.options.lineColor||t.cursorColor||t.progressColor;this.wrapper.setAttribute("part","hover"),Object.assign(this.wrapper.style,{position:"absolute",zIndex:10,left:0,top:0,height:"100%",pointerEvents:"none",borderLeft:this.addUnits(this.options.lineWidth)+" solid "+t,transition:"opacity .1s ease-in"}),this.label.setAttribute("part","hover-label"),Object.assign(this.label.style,{display:"block",backgroundColor:this.options.labelBackground,color:this.options.labelColor,fontSize:""+this.addUnits(this.options.labelSize),transition:"transform .1s ease-in",padding:"2px 3px"});const e=this.wavesurfer.getWrapper();e.appendChild(this.wrapper),e.addEventListener("pointermove",this.onPointerMove),e.addEventListener("pointerleave",this.onPointerLeave),this.unsubscribe=()=>{e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerleave",this.onPointerLeave)}}formatTime(t){return Math.floor(t/60)+":"+("0"+Math.round(t)%60).slice(-2)}destroy(){super.destroy(),this.unsubscribe(),this.wrapper.remove()}}export{i as default};